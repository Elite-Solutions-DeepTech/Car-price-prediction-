# -*- coding: utf-8 -*-
"""Untitled9.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1GhccMBpHyT9SC7poMOv1fUCveG1D420-
"""

import numpy as np
import pandas as pd

data=pd.read_csv('/content/CarPrice_Assignment.csv')

data

data.shape

from sklearn.preprocessing import LabelEncoder
le=LabelEncoder()
columns_to_encode=['CarName','fueltype','aspiration','doornumber','carbody','drivewheel','enginelocation','enginetype','cylindernumber','fuelsystem']
for column in columns_to_encode:
    data[column]=le.fit_transform(data[column])

data.isnull().sum()

data.dtypes

x=data.iloc[:,:-1]

y=data.iloc[:,-1]

from sklearn import model_selection
x_train,x_test,y_train,y_test=model_selection.train_test_split(x,y)

print(x_train.shape)
print(x_test.shape)
print(y_train.shape)
print(y_test.shape)

from sklearn.linear_model import LinearRegression
alg=LinearRegression()

alg.fit(x_train,y_train)

y_pred=alg.predict(x_test)

accuracy=alg.score(x_train,y_train)

print(accuracy)

from sklearn.metrics import r2_score,accuracy_score
accuracy2=r2_score(y_test,y_pred)

print(accuracy2)

import matplotlib.pyplot as plt

plt.scatter(y_test,y_pred)
plt.show()

plt.scatter(y_test,y_pred,color='black')
plt.plot([y_test.min(),y_test.max()],[y_test.min(),y_test.max()],color='violet',linewidth=3)
plt.xlabel('Actual')
plt.ylabel('predicted')
plt.title('Car Price Prediction ')
plt.grid(True)
plt.show()